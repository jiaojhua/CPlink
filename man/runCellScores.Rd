% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CPscore.R
\name{runCellScores}
\alias{runCellScores}
\title{Compute Weighted Cell/Spot Scores Based on Phenotype-Associated Features}
\usage{
runCellScores(
  dist_mat,
  marker_mat,
  up_weight = 0.5,
  down_weight = 0.5,
  direction_col = "logFC"
)
}
\arguments{
\item{dist_mat}{A matrix (features x cells/spots) where rows are features
(genes/peaks) and columns are cells/spots. Higher values indicate
stronger feature-cell/spot associations.}

\item{marker_mat}{Data frame or matrix of phenotype-associated markers
identified  from reference (bulk) data. Must include:
       \itemize{
         \item Rows: Marker features (must overlap with dist_mat rownames)
         \item Column specified by direction_col: signed values representing
               effect sizes or directionality (e.g., log fold change)
       }}

\item{up_weight}{Numeric scalar specifying the contribution of upregulated markers
to the final cell score (default: 0.5)}

\item{down_weight}{Numeric scalar specifying the contribution of downregulated markers
to the final cell score (default: 0.5)}

\item{direction_col}{Column name in marker_mat containing directional
information (default: "logFC")}
}
\value{
Numeric vector of length equal to the number of cells or spots,
        representing phenotype-association scores for each cell or spot.
}
\description{
This function calculates initial cell/spot-phenotype association scores by
aggregating phenotype-associated feature-cell associations derived from
single-cell or spatial omics data.
}
