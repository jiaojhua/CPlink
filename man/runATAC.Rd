% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DataPrep.R
\name{runATAC}
\alias{runATAC}
\title{Run standard scATAC-seq preprocessing and visualization}
\usage{
runATAC(
  matrix,
  meta.data,
  ranges = NULL,
  genome = NULL,
  sep = c("-", "-"),
  batch_correct = FALSE,
  batch_var = "batch",
  min.cells = 3,
  min.cutoff = "q0",
  resolution = 0.8,
  dims_Neighbors = 2:50,
  dims_UMAP = 2:50,
  fragments = NULL
)
}
\arguments{
\item{matrix}{A count matrix with peaks/bins as rows and cells as columns.}

\item{meta.data}{A data frame containing cell-level metadata. Row names must match the column names of `matrix`.}

\item{ranges}{A GRanges object specifying genomic ranges for peaks. If NULL, ranges will be inferred from `matrix` row names.}

\item{genome}{Genome identifier (e.g., "hg38"). Required if ranges not provided.}

\item{sep}{Separator characters in peak names (default c("-", "-") for "chr-start-end" format)}

\item{batch_correct}{Logical indicating whether to perform Harmony batch correction (default: FALSE)}

\item{batch_var}{Metadata column name containing batch information (default: "tech")}

\item{min.cells}{Minimum cells required to keep a peak (default: 3)}

\item{min.cutoff}{Minimum cutoff for FindTopFeatures ("q0" uses all features, see ?FindTopFeatures)}

\item{resolution}{Cluster resolution parameter (default: 0.8)}

\item{dims_Neighbors}{Dimensions for FindNeighbors (default: 2:50)}

\item{dims_UMAP}{Dimensions for UMAP projection (default: 2:50)}

\item{fragments}{Path to fragments file (optional, for fragment counting)}
}
\value{
A Seurat object containing all analysis results.
}
\description{
This function performs a complete single-cell ATAC-seq analysis workflow, including
chromatin assay construction, TF-IDF normalization, highly informative feature selection,
Latent Semantic Indexing (LSI) dimensionality reduction, optional batch effect correction via Harmony,
graph-based clustering, and UMAP visualization. The resulting Seurat object can be used for
downstream analyses.
}
